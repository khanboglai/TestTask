## Зависимости

Необходимые библиотеки находятся в файле `requirements.txt`.

## Задание 1

Данные сохраняются в json. Есть возможность настроить интервал для повторного запуска программы. 

Интервал и директория для сохранения задаются в файле `config.cfg`. Также есть дефолтная конфигурация на случай, если файл не существует.

Программа останавливается по кнопке `q`.

Можно выбрать определенные классы окон для отслеживания.

## Задание 2

Настройка директории для сохранения и интервала времени задаются также в файле `config.cfg`.

Программа останавливается по кнопке `q`.

Для удобства программа собирает данные о подключенных `службах`, `дисках`, `usb` устройствах и устройствах `bluetooth`.


## Задание 3

За основу взял код от задания 2. Написал функцию для сравнения словарей.

Берем текущее время и предыдущее и сравниваем. Предыдущее время берем либо в текущий день, либо последнюю записть за предыдущий день.

Если нашлись различия, то отправляем сообщения в канал в телеграме.

При **первом** запуске в канал отправится сообщение о всех подключенных устройствах.

## Задание 4

За основу взял код от задания 1. Добавил сохранение `pid` окна и исполняемый файл. 
Выбираем pid браузера и добавляем в список.

Отслеживаем процесс по pid из списка и обновляем список, если процесс завершен.

Пока список не будет пуст, мониторинг не отключится.

Для мониторинга использовал `Mitmproxy`. Написал класс (`traffic_monitor.py`) для запуска и работы с прокси сервисом.
Пока список pid не пуст, в отдельном процессе (как отдельная задача Windows) работает прокси сервер. Как только список опустеет, останавливаем процесс с сервером.

Чтобы при работе через интервалы, не создавался повторно процесс с прокси сервером, отслеживаем состояние и обновляем его в переменной `mitm_state`.

**Какие запросы отслеживаем?** Рассматриваются запросы http и https. Исключаются из рассмотрения запросы с аналитикой и стилями. То есть, смотрим исключительно на запросы пользователя. 

Программа позволяем получить почти все данные, которые передаются в запросе, вплоть до логина и пароля.


Чтобы не делать дополнительных настроек в системе, написал функции для настройки прокси в Windows. Функции лежат в файле `set_proxy.py`.